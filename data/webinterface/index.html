<!doctype html>

<html lang="en">

<head>
	<meta charset="utf-8">
	
	<title>WiFi Matrix</title>
	<meta name="description" content="RGB Led Matrix Webinterface">
	<meta name="author" content="Amon Benson">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

	<link rel='icon' href='data:image/png;base64,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' type='image/x-png' />
	
	<style>
		* {
			font-family: sans-serif;
			
			-webkit-tap-highlight-color: transparent;
			user-select: none;
		}
		
		html {
			height: 100%;
		}
		
		body {
			height: 100%;
			margin: 0;
			background-repeat: no-repeat;
			background-attachment: fixed;
			background: linear-gradient(150deg, #243b55, #141e30);
			
			font-size: 100%;
			overflow: hidden;
		}
		
		a {
			all: initial;
		}
		
		.titletext {
			position: absolute;
			font-size: 4.0rem;
			
			color: white;
			text-align: center;
			
			left: 1rem;
			right: 1rem;
			top: 1rem;
		}
		
		.controlbar {
			position: absolute;
			z-index: 1;
			
			left: 0;
			right: 0;
			top: 50%;
			
			font-size: 1.6rem;
			text-align: center;
			
			padding: 0.5rem 2rem;
			margin: none;
			
			opacity: 0.9;
			background-color: white;
			color: #000000;
			
			box-shadow: 0px 1px 15px -5px;
			transform: translateY(-50%);
		}
		
		.controlbar-button {
			background-color: #FFFFFF;
			font-size: 1.5rem;
			
			vertical-align: center;
			
			padding: 0.4em 0.8em;
			
			border: none;
			border-radius: 0.3em;
			cursor: pointer;
			
			transition: filter 0.1s, transform 0.1s;
		}
		
		.controlbar-button:active {
			filter: brightness(95%) !important;
			
			transform: scale(0.97);
		}

		.controlbar-button:focus {
			outline: none;
		}
		
		.cornerbutton-container {
			position: absolute;
			z-index: 2;
		
			left: 0.5rem;
			bottom: 0.5rem;
		}
		
		.cornerbutton {
			width: 0.1px;
			height: 0.1px;
			opacity: 0;
			overflow: hidden;
			position: absolute;
			z-index: -1;
		}
		
		.cornerbutton + label {
			display: inline-block;
			font-size: 1.3rem;

			height: 1.6rem;
			vertical-align: bottom;
			
			margin: 0.5rem;
			padding: 0.6em 1.2em;
			cursor: pointer;
			
			border: none;
			border-radius: 0.3em;
			
			background-color: white;
			color: black;
			
			transition: filter 0.3s, transform 0.3s;
		}
		
		.cornerbutton + label:active {
			filter: brightness(70%) !important;
			
			transform: scale(0.97);
		}
		
		.infotext {
			position: absolute;
			
			color: white;
			text-align: center;
			
			left: 1em;
			right: 1em;
			bottom: calc(50% + 3em);
		}
		
		.credittext {
			position: absolute;
			z-index: 2;

			font-size: 0.6rem;
			
			right: 1em;
			bottom: 1em;
		
			color: white;
			opacity: 0.2;
		}
		
		/* Mobile specific styling */
		@media only screen and (max-width: 768px) {
			.titletext {
				font-size: 2.5rem;
			}
			
			.credittext {
				/*text-align: center;*/
			}

			.text-short {
				display: inline-block;
			}

			.text-long {
				display: none;
			}
		}
		
		/* Desktop specific styling */
		@media only screen and (min-width: 769px) {
			.controlbar-button:hover {
				filter: brightness(97%);
			}
			
			.fileupload-container:hover {
				filter: brightness(90%);
			}

			.text-short {
				display: none;
			}

			.text-long {
				display: inline-block;
			}
		}
	</style>
</head>
<body>

<div class="titletext">
	WiFi Matrix
</div>

<div class="controlbar">
	<input type="button" class="controlbar-button" id="button-prev" onclick="prevOnclick()" value="&#9665;&#9665;">
	<input type="button" class="controlbar-button" id="button-play" onclick="playOnclick()" value="&#9707;">
	<input type="button" class="controlbar-button" id="button-next" onclick="nextOnclick()" value="&#9655;&#9655;">
</div>

<div class="infotext" id="infotext"></div>

<div class="cornerbutton-container">
	<form method="post" enctype="multipart/form-data" action="/upload">
		<input type="file" class="cornerbutton" id="fileupload" name="fileupload" onchange="this.form.submit()">
		<label for="fileupload">
			<span class="text-long">GIF Datei hochladen</span>
			<span class="text-short">&#8682;</span>
		</label>

		<input type="button" class="cornerbutton" id="deletecurrent">
		<label for="deletebutton">
			<span class="text-long">Aktuelle Animation löschen</span>
			<span class="text-short">&#9747;</span>
		</label>
	</form>
</div>

<div class="credittext">Copyright &copy; 2018&emsp;Amon Benson</div>

<script>

var fadeOutUpdater;
var playing = true;



// Register events
/*document.addEventListener("DOMContentLoaded", function() {
  // File uploader change event
  document.getElementById('gif-fileupload').addEventListener('change', gifFileuploadOnchange, false);
});*/



function playOnclick() {
	playing = !playing;
	
	var req = new XMLHttpRequest();
	req.onreadystatechange = function() {
		if (this.readyState == 4 && status == 200) {
			console.log("SUCCESS");
		}
	}

	if (playing) {
		setInfoText("Gestartet");
		document.getElementById("button-play").innerHTML = "&#9707;";
		req.open("POST", "/control/play");
	} else {
		setInfoText("Pausiert");
		document.getElementById("button-play").innerHTML = "&#9655;";
		req.open("POST", "/control/pause");
	}
	
	req.send();
}

function nextOnclick() {
	setInfoText("Nächste Animation");
	
	var req = new XMLHttpRequest();
	req.onreadystatechange = function() {
		if (this.readyState == 4 && status == 200) {
			console.log("SUCCESS");
		}
	}
	
	req.open("POST", "/control/next");
	req.send();
}

function prevOnclick() {
	setInfoText("Vorherige Animation");
	
	var req = new XMLHttpRequest();
	req.onreadystatechange = function() {
		if (this.readyState == 4 && status == 200) {
			console.log("SUCCESS");
		}
	}
	
	req.open("POST", "/control/prev");
	req.send();
}

function gifFileuploadOnchange(evt) {
	setInfoText("Wird hochgeladen...");
	
	evt.stopPropagation();
    evt.preventDefault();
	
	var uploadFile = evt.target.files[0];
	if (!uploadFile) return;
	
	// Create the file to be sent
	var reader = new FileReader();
	
	// Add the metadata
	var data = new Object();
    data.name = uploadFile.name;
    data.date = uploadFile.lastModified;
    data.size = uploadFile.size;
    data.type = uploadFile.type;
	
	// Add the read listener
	reader.onload = function(fileData) {
		data.fileData = fileData.target.result;
		
		// Send the file
		var req = new XMLHttpRequest();
		req.onreadystatechange = function() {
			if (this.readyState == 4 && status == 200) {
				console.log("SUCCESS");
			}
		}
		
		req.open("POST", "/upload/gif");
		req.send();
    }
	
	// Read the selected file to send it over.
	reader.readAsDataURL(uploadFile);
}

function setInfoText(text) {
	var infoText = document.getElementById("infotext");
	
	infoText.innerHTML = text;
	infoText.style.opacity = 1.0;
	
	clearInterval(fadeOutUpdater);
	fadeOutUpdater = setTimeout(function() { fadeOut(infoText) }, 2000);
}

function fadeOut(element) {
	element.style.opacity -= 0.05;
	if (element.style.opacity <= 0.01) {
		element.style.opacity = 0;
		return;
	}
	
	fadeOutUpdater = setTimeout(function() { fadeOut(element) }, 30);
}

</script>

</body>